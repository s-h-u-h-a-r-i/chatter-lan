---
alwaysApply: true
---

# PROJECT RULES - CRITICAL: READ ALL SECTIONS BEFORE CODING

## RULE 1: FILE ORGANIZATION (MANDATORY)

When creating or moving files, you MUST follow these paths:

- Feature-specific logic → `/src/app/pages/[feature]/`
  - Components → `/src/app/pages/[feature]/components/`
  - Types → `/src/app/pages/[feature]/types/`
- Shared/reusable logic → `/src/lib/`
- Reusable generic components → `/src/components/`
- Global application state → `/src/store/`

## RULE 2: CSS AND STYLING (MANDATORY)

- MUST use color variables from: `/src/styles/_colors.css`
- MUST import CSS and apply default element styles in: `/src/styles/index.css`
- DO NOT hardcode colors or create new CSS files without checking existing structure

## RULE 3: CODE QUALITY DECISIONS (MANDATORY)

When writing code, you MUST:

1. **Consider architectural improvements**: Do not just match existing patterns. Suggest improvements that prevent future issues.
2. **Think ahead**: Consider edge cases and potential conflicts before implementing.
3. **Prefer abstraction**: When multiple similar patterns exist, suggest generic or abstract solutions that reduce duplication.
4. **Balance simplicity with robustness**: Simple code is good, but NOT at the expense of type safety or maintainability.

## RULE 4: JSDOC COMMENTS (CRITICAL - READ CAREFULLY)

### 4.1 MANDATORY STRUCTURE

Every JSDoc comment MUST:

- Start with `###` followed by a short summary statement
- Omit type annotations in `@param` tags (use `@param name Description` NOT `@param {type} name Description`)
- Use language that remains accurate even if implementation changes

### 4.2 CONTENT RULES (MOST CRITICAL)

**MUST DO:**

- Focus on the abstract purpose and value proposition
- Document "why" and "what problem it solves"
- Use timeless language that describes the problem/benefit, not the mechanism

**MUST NOT:**

- List specific features or capabilities (e.g., "provides X, Y, and Z")
- Describe implementation details (e.g., "uses structuredClone", "maintains separation")
- Explain "how it works" or "what it currently does"
- Mention specific methods, algorithms, or data structures

### 4.3 VALIDATION CHECKLIST

Before writing any JSDoc, ask yourself:

1. Does this describe WHY someone would use this? ✓
2. Does this describe WHAT PROBLEM it solves? ✓
3. Would this still be accurate if the implementation changed? ✓
4. Does this avoid listing features? ✓
5. Does this avoid describing how it works? ✓

If ANY answer is NO, rewrite the JSDoc.

### 4.4 EXAMPLES - CLASS/INTERFACE DOCUMENTATION

**MUST NOT (WRONG):**

```typescript
/**
 * ### Base class for Firestore document models
 *
 * Provides change tracking, validation, and safe updates. Maintains
 * separation between original and pending changes.
 */
```

**Why wrong:** Lists features ("change tracking, validation, safe updates") and describes mechanism ("maintains separation")

**MUST DO (CORRECT):**

```typescript
/**
 * ### Base class for Firestore document models
 *
 * Enables type-safe, controlled updates to Firestore documents by providing
 * a consistent interface for managing document state and ensuring data integrity
 * before persistence.
 */
```

**Why correct:** Describes value ("enables type-safe, controlled updates") and problem solved ("ensuring data integrity")

### 4.5 EXAMPLES - METHOD/FUNCTION DOCUMENTATION

**MUST NOT (WRONG):**

```typescript
/**
 * ### Reset pending changes
 *
 * Copies the original data to pending data using structuredClone.
 */
```

**Why wrong:** Describes implementation ("using structuredClone") and mechanism ("copies")

**MUST DO (CORRECT):**

```typescript
/**
 * ### Discard pending changes and reset to original state
 *
 * Reverts all pending modifications back to the original data state,
 * effectively canceling any unsaved changes.
 */
```

**Why correct:** Describes purpose ("discard", "cancel unsaved changes") and outcome ("reverts to original state")

### 4.6 EXAMPLES - PARAMETER DOCUMENTATION

**MUST NOT (WRONG):**

```typescript
/**
 * @param {string} id - ID of user for lookup
 */
```

**Why wrong:** Includes type annotation `{string}`

**MUST DO (CORRECT):**

```typescript
/**
 * @param id Unique identifier for the user to retrieve
 */
```

**Why correct:** No type annotation, describes purpose not type

### 4.7 ANTI-PATTERNS TO AVOID

When writing JSDoc, NEVER:

- Start with "This function/class/method..." (redundant)
- List features: "Provides X, Y, Z capabilities"
- Describe algorithms: "Uses binary search to find..."
- Mention specific libraries: "Uses React hooks to..."
- Explain step-by-step: "First it does X, then Y, then Z"
- Reference implementation details: "Stores data in Map", "Calls API endpoint"

INSTEAD, write about:

- The problem it solves
- The value it provides
- Why someone would use it
- What outcome it produces

### 4.8 DECISION TREE FOR JSDOC

```
When writing JSDoc:
├─ Does it describe WHY? → YES → Continue
│  └─ NO → Rewrite to focus on purpose/value
├─ Does it describe WHAT PROBLEM? → YES → Continue
│  └─ NO → Rewrite to explain problem solved
├─ Does it avoid HOW? → YES → Continue
│  └─ NO → Remove implementation details
├─ Does it avoid feature lists? → YES → Continue
│  └─ NO → Remove feature enumeration
└─ Would it be accurate if code changed? → YES → ✓ CORRECT
   └─ NO → Make more abstract
```
